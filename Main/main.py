import yfinance as yf
import pandas as pd
import csv
import random

def run():
    nasdaqTickers = ["AAL",
    "AAPL",
    "ADBE",
    "ADI",
    "ADP",
    "ADSK",
    "AKAM",
    "ALXN",
    "AMAT",
    "AMGN",
    "AMZN",
    "ATVI",
    "AVGO",
    "BBBY",
    "BIDU",
    "BIIB",
    "BMRN",
    "CA",
    "CELG",
    "CERN",
    "CHKP",
    "CHTR",
    "CMCSA",
    "COST",
    "CSCO",
    "CSX",
    "CTRP",
    "CTSH",
    "CTXS",
    "DISCA",
    "DISCK",
    "DISH",
    "DLTR",
    "EA",
    "EBAY",
    "ESRX",
    "EXPE",
    "FAST",
    "FB",
    "FISV",
    "FOX",
    "FOXA",
    "GILD",
    "GOOGL",
    "HSIC",
    "ILMN",
    "INCY",
    "INTC",
    "INTU",
    "ISRG",
    "JD",
    "KHC",
    "LBTYA",
    "LBTYK",
    "LLTC",
    "LRCX",
    "LVNTA",
    "MAR",
    "MAT",
    "MCHP",
    "MDLZ",
    "MNST",
    "MSFT",
    "MU",
    "MXIM",
    "MYL",
    "NCLH",
    "NFLX",
    "NTAP",
    "NTES",
    "NVDA",
    "NXPI",
    "ORLY",
    "PAYX",
    "PCAR",
    "PCLN",
    "PYPL",
    "QCOM",
    "QVCA",
    "REGN",
    "ROST",
    "SBAC",
    "SBUX",
    "SIRI",
    "SRCL",
    "STX",
    "SWKS",
    "SYMC",
    "TMUS",
    "TRIP",
    "TSCO",
    "TSLA",
    "TXN",
    "ULTA",
    "VIAB",
    "VOD",
    "VRSK",
    "VRTX",
    "WBA",
    "WDC",
    "WFM",
    "XLNX",
    "YHOO",
    "XRAY",
    "NDX"]
    nasdaq100 = [
    "AAPL",
    "MSFT",
    "AMZN",
    "GOOG",
    "FB",
    "TSLA",
    "NVDA",
    "PYPL",
    "ADBE",
    "CMCSA",
    "CSCO",
    "NFLX",
    "PEP",
    "INTC",
    "COST",
    "AVGO",
    "TMUS",
    "TXN",
    "QCOM",
    "VTRS",
    "HON",
    "CHTR",
    "INTU",
    "SBUX",
    "AMGN",
    "AMD",
    "ISRG",
    "AMAT",
    "GILD",
    "ADP",
    "MDLZ",
    "MELI",
    "BKNG",
    "LRCX",
    "WTW",
    "MU",
    "CSX",
    "ILMN",
    "FISV",
    "ADSK",
    "REGN",
    "ATVI",
    "ASML",
    "ADI",
    "IDXX",
    "NXPI",
    "UAL",
    "ALGN",
    "BIIB",
    "JD",
    "MNST",
    "VRTX",
    "EBAY",
    "KLAC",
    "AAL",
    "WDC",
    "LULU",
    "CELG",
    "KHC",
    "SNPS",
    "WDAY",
    "ROST",
    "WBA",
    "MAR",
    "PAYX",
    "ORLY",
    "CDNS",
    "CTAS",
    "CTSH",
    "EA",
    "MCHP",
    "XEL",
    "BIDU",
    "XLNX",
    "JBHT",
    "FAST",
    "VRSK",
    "HAS",
    "BMRN",
    "CTXS",
    "EXPE",
    "LBTYA",
    "TTWO",
    "ULTA",
    "NTAP",
    "SWKS",
    "NLOK",
    "PCAR",
    "HSIC",
    "MXIM",
    "NTES",
    "SIRI",
    "CERN",
    "VRSN",
    "WYNN",
    "DLTR",
    "INCY",
    "CHKP",
    "TCOM",
    "FOX",
    ]

    file = pd.read_csv('IWM_holdings.csv')
    randomlist = random.sample(range(1, 1958), 100)
    tickers = []
    for num in randomlist:
        stock_row = file.iloc[num]
        tickers.append(stock_row[0])

    tickers = nasdaqTickers
    datalist = []
    for stock in tickers:
        data = yf.Ticker(stock).history(start=pd.to_datetime("2010-01-02"))
        ye = data['Close'].tolist()
        ye.reverse()
        datalist.append(pd.Series(ye))
    df = pd.DataFrame(datalist)
    df = df.transpose()
    df.columns = tickers
    data = yf.Ticker('SPY').history(start=pd.to_datetime("2010-01-01"))

    index = data.index
    index = index.to_list()
    print(index)
    print(df)
    df
    index.reverse()
    df.index = index

    df.to_csv("nasdaq_data.csv")